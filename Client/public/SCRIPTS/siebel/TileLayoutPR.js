/*<ORACLECOPYRIGHT>
* Copyright (C) 2008-2016
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 16.0.0.0SIA[23057] */
typeof SiebelAppFacade.TileLayoutPR=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.TileLayoutPR"),define("siebel/TileLayoutPR",["siebel/phyrenderer"],function(){return SiebelAppFacade.TileLayoutPR=function(){function o(e){var t;this.init=!0,this.SetBasicLayout=function(e){t=e},this.GetBasicLayout=function(){return t};var n;this.SetTileScrollDirection=function(e){n=e},this.GetTileScrollDirection=function(){return n};var r;this.SetContainer=function(e){r=e},this.GetContainer=function(){return r};var i;this.SetScrollAmount=function(e){i=e},this.GetScrollAmount=function(){return i};var s=0;this.SetTileHeight=function(e){s=e},this.GetTileHeight=function(){return s};var o=0;this.SetTileWidth=function(e){o=e},this.GetTileWidth=function(){return o};var a=0;this.SetContainerWidth=function(e){a=e},this.GetContainerWidth=function(){return a};var f=0;this.SetContainerHeight=function(e){f=e},this.GetContainerHeight=function(){return f};var l;this.SetIScrollObject=function(e){l=e},this.GetIScrollObject=function(e){return l},e.AddProperty("GetSelId",T),SiebelAppFacade.TileLayoutPR.superclass.constructor.call(this,e),SiebelApp.S_App.PluginBuilder.SetUIContext(this,u)}function u(e){return e&&e.GetUIType()===t.get("SWE_CTRL_RADIO")?this.GetContainer().find("[name*="+e.GetInputName()+"]"):null}function a(){var e=this.GetIScrollObject();e&&(e.destroy(),d.call(this))}function f(e,t,n){var r;return function(){var i=n||this,s=arguments,o=function(){r=null,e.apply(i,s)};clearTimeout(r),r=setTimeout(o,t)}}function l(){var e=this,t=this.GetPM(),n=e.GetContainer(),r=t.Get("IsResponsive")?n.parent().attr("data-scroll-direction"):n.attr("data-scroll-direction"),i,s,o;return r?o=r:(i=n.parent(".siebui-tile-container").outerWidth(!0)||0,s=e.GetTileWidth(),o=s>0&&i<=s*1.5?"Vertical":"Horizontal"),n=null,o}function c(){var e=(l.call(this)||"").toLowerCase(),t=this.GetIScrollObject();if(!t||e==="horizontal"&&t.options.scrollX===!0&&t.options.scrollY===!1||e==="vertical"&&t.options.scrollX===!1&&t.options.scrollY===!0){e=t=null;return}var n=this.GetPM(),r=n.Get("GetRecordSet"),i=r?r.length:0,s=this.GetContainer(),o=s.find(".siebui-tile-list>.siebui-tile").eq(0).attr("id"),u=!1,a=!0;e==="horizontal"&&(u=!0,a=!1),this.SetTileScrollDirection(e),SiebelAppFacade.DecisionManager.IsTouch()||this.EnhanceScroller(),e==="horizontal"?(x.call(this,"#tile-left-scroll","#tile-right-scroll","ScrollPrevData","ScrollNextData",SCROLL_UP,"margin-left","marginLeft","mousedown"),x.call(this,"#tile-right-scroll","#tile-left-scroll","ScrollNextData","ScrollPrevData",SCROLL_DN,"margin-left","marginLeft","mousedown")):(x.call(this,"#tile-up-scroll","#tile-down-scroll","ScrollPrevData","ScrollNextData",SCROLL_UP,"","scrollTop","mousedown"),x.call(this,"#tile-down-scroll","#tile-up-scroll","ScrollNextData","ScrollPrevData",SCROLL_DN,"","scrollTop","mousedown")),this.SetFirstTileId.call(this,o,i),t.options.scrollX=u,t.options.scrollY=a,t.refresh(),t=s=n=r=null}function h(){return this.GetPM().Get("IsResponsive")?!this.GetContainer().parent().attr("data-scroll-direction"):!this.GetContainer().attr("data-scroll-direction")}function p(){var e=this.GetPM(),t=e.Get("GetControls"),n,r,i,s,o,u=SiebelApp.S_App.GetRequiredIndicator();for(var a in t)t.hasOwnProperty(a)&&(n=t[a],s=e.ExecuteMethod("IsRequired",n.GetName()),s&&(r=$('[name="'+n.GetInputName()+'"]')[0]||$("#"+n.GetInputName())[0],r&&(r=$(r),i=r.attr("aria-labelledby")||"",i&&(i=i.split(" ",1),o=i[0].replace("/","\\/"),this.GetContainer().children().find("#"+o).eq(0).after(u)))));t=n=r=u=null}function d(){function o(e,t){}var e=!0,n=!1,r=null,i=0,s="#"+this.GetPM().Get("GetFullId")+"_"+t.get("SWE_TILE_CONTAINER");this.GetTileScrollDirection().toLowerCase()==="horizontal"&&(n=!0,e=!1,SiebelApp.S_App.GetDirection()&&(i=this.GetContainer().find(".siebui-tile").width()-this.GetContainer().children("div.siebui-tile-list").width())),r=new IScroll(s,{infiniteElements:$(s).children("div.siebui-tile-list"),infiniteLimit:1,dataset:o,cacheSize:10,tap:!1,click:!1,scrollX:n,scrollY:e,ctx:this,startX:i,bindToWrapper:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|SPAN|DIV|UL|LI|IMG|A|I)$/}}),SiebelApp.S_App.GetDirection()&&this.GetTileScrollDirection().toLowerCase()==="horizontal"&&r.scrollToElement($(s).find("div.siebui-tile").first()[0],0),r.options.scrollY&&(r.maxScrollY=-(r.scrollerHeight-r.wrapperHeight),r.wrapperHeight>=r.scrollerHeight&&(r.maxScrollY=0)),r.on("scrollEnd",m),this.SetIScrollObject(r)}function v(e){var t=e.data.ctx,n=t.GetIScrollObject();n&&n.options.scrollY&&(n.refresh(),n.maxScrollY=-(n.scrollerHeight-n.wrapperHeight),n.wrapperHeight>=n.scrollerHeight&&(n.maxScrollY=0),Math.abs(n.maxScrollY)&&t.EnableScrollArrow($("#"+n.wrapper.id).find("#tile-down-scroll")))}function m(){var e=!1,t=0,n,r,i,s=this.options.ctx,o=parseInt(s.GetPM().Get("GetRecordSet").length),u=this.scroller.getBoundingClientRect();s.GetContainer().find("."+this.scroller.className+"").addClass("siebui-iscroll"),this.options.scrollX?(t=this.directionX,SiebelApp.S_App.GetDirection()&&(t=-t),t===0?t=this.distX>0?-1:1:t,SiebelApp.S_App.GetDirection()?e=t>0?this.x+this.scroller.offsetLeft>=0:-(this.x-this.scroller.offsetLeft)>=-this.maxScrollX:e=t>0?-(this.x-this.scroller.offsetLeft)>=-this.maxScrollX:this.x+this.scroller.offsetLeft>=0,i=parseInt($("#"+this.scroller.firstChild.id).outerWidth(!0),10),n=Math.round(this.wrapperWidth/i),o>=n&&s.EnableScrollArrow($("#"+this.wrapper.id).find("#tile-left-scroll, #tile-right-scroll"))):(t=this.directionY,t===0?t=this.distY>0?-1:1:t,r=u.top>0?u.top:-u.top,e=t>0?s.GetContainer().children("div.siebui-tile-list").offset().top+this.scrollerHeight-($("#"+this.wrapper.id).offset().top+this.wrapperHeight)<=0:this.y>=0,i=parseInt($("#"+this.scroller.firstChild.id).outerHeight(!0),10),n=Math.round(this.wrapperHeight/i),o>=n&&s.EnableScrollArrow($("#"+this.wrapper.id).find("#tile-up-scroll, #tile-down-scroll")));if(e&&!s.GetContainer().data("ScrollPending")){var a=s.GetPM(),f
,l;SiebelApp.S_App.GetDirection()?(f="ScrollPrevData",l="ScrollNextData",SCROLL_UP=consts.get("PAG_SCROLL_DN"),SCROLL_DN=consts.get("PAG_SCROLL_UP"),t=-t):(f="ScrollNextData",l="ScrollPrevData",SCROLL_UP=consts.get("PAG_SCROLL_UP"),SCROLL_DN=consts.get("PAG_SCROLL_DN")),t>0&&a.ExecuteMethod("CanInvokeScrollMethod",f)?(s.GetContainer().data("ScrollPending",!0),a.OnControlEvent(consts.get("PHYEVENT_VSCROLL_LIST"),SCROLL_DN)):t<0&&a.ExecuteMethod("CanInvokeScrollMethod",l)?(s.GetContainer().data("ScrollPending",!0),a.OnControlEvent(consts.get("PHYEVENT_VSCROLL_LIST"),SCROLL_UP)):this.options.scrollX&&o>=n?(SiebelApp.S_App.GetDirection()&&(t=-t),t>0?SiebelApp.S_App.GetDirection()?($("#"+this.wrapper.id).find("#tile-left-scroll").addClass("siebui-tile-scroll-d"),$("#"+this.wrapper.id).find("#tile-right-scroll").removeClass("siebui-tile-scroll-d")):($("#"+this.wrapper.id).find("#tile-right-scroll").addClass("siebui-tile-scroll-d"),$("#"+this.wrapper.id).find("#tile-left-scroll").removeClass("siebui-tile-scroll-d")):SiebelApp.S_App.GetDirection()?($("#"+this.wrapper.id).find("#tile-right-scroll").addClass("siebui-tile-scroll-d"),$("#"+this.wrapper.id).find("#tile-left-scroll").removeClass("siebui-tile-scroll-d")):($("#"+this.wrapper.id).find("#tile-left-scroll").addClass("siebui-tile-scroll-d"),$("#"+this.wrapper.id).find("#tile-right-scroll").removeClass("siebui-tile-scroll-d"))):o>=n&&(SiebelApp.S_App.GetDirection()&&(t=-t),t>0?($("#"+this.wrapper.id).find("#tile-down-scroll").addClass("siebui-tile-scroll-d"),$("#"+this.wrapper.id).find("#tile-up-scroll").removeClass("siebui-tile-scroll-d")):($("#"+this.wrapper.id).find("#tile-up-scroll").addClass("siebui-tile-scroll-d"),$("#"+this.wrapper.id).find("#tile-down-scroll").removeClass("siebui-tile-scroll-d")))}}function g(){var e=!1,t=0,n=0,r,i,s,o,u,a=parseInt(this.GetPM().Get("GetRecordSet").length),f,l=this.GetContainer(),c=this.GetIScrollObject(),h=c.scroller.getBoundingClientRect();c.options.scrollX?(t=c.directionX,SiebelApp.S_App.GetDirection()&&(t=-t),t===0?t=c.distX>0?-1:1:t):(t=c.directionY,t===0?t=c.distY>0?-1:1:t),s=parseInt(this.GetScrollAmount(),10),s=s<0?-s:s;if(c.options.scrollX)u=parseInt($("#"+c.scroller.firstChild.id).outerWidth(!0),10),r=Math.round(c.wrapperWidth/u),c.x=t>0?c.x:0,o=s*u,SiebelApp.S_App.GetDirection()?t>0?n=c.wrapperWidth>o?-(c.scrollerWidth-c.wrapperWidth):-o:n=o>-c.x?-u:o- -c.x:c.x===0?n=c.wrapperWidth>o?-(c.scrollerWidth-c.wrapperWidth):-o:n=o>-c.x?0:o- -c.x;else{u=parseInt($("#"+c.scroller.firstChild.id).outerHeight(!0),10),r=Math.round(c.wrapperHeight/u),c.y=t>0?c.y:0,o=s*u;if(c.y===0){var p=Math.floor(this.GetContainer().width()/this.GetTileWidth())||1;n=-1*(s/p)*u}else n=o>-c.y?0:o- -c.y}c.options.scrollX?n=c.wrapperWidth>=c.scrollerWidth?0:n:n=c.wrapperHeight>=c.scrollerHeight?0:n,setTimeout(function(){l.removeData("ScrollPending"),l=null},100),c.options.scrollX?c.scrollTo(n,0):c.scrollTo(0,n),f=t>0?this.GetPM().Get("GetRecordSet").length-1-s:(this.GetPM().Get("GetRecordSet").length,10-s),f=parseInt(f,10),!this.GetPM().Get("MultiSelectColumn")&&!this.GetPM().Get("MultiSelectMode")&&(this.OnRowSelect(f),this.ShowSelection())}function y(e,t){var n=e.GetPM(),r,i;return SiebelApp.S_App.GetDirection()?(r="ScrollPrevData",i="ScrollNextData",SCROLL_UP=consts.get("PAG_SCROLL_DN"),SCROLL_DN=consts.get("PAG_SCROLL_UP"),t=-t):(r="ScrollNextData",i="ScrollPrevData",SCROLL_UP=consts.get("PAG_SCROLL_UP"),SCROLL_DN=consts.get("PAG_SCROLL_DN")),t>0&&n.ExecuteMethod("CanInvokeScrollMethod",r)?(n.OnControlEvent(consts.get("PHYEVENT_VSCROLL_LIST"),SCROLL_DN),!0):t<0&&n.ExecuteMethod("CanInvokeScrollMethod",i)?(n.OnControlEvent(consts.get("PHYEVENT_VSCROLL_LIST"),SCROLL_UP),!0):!1}function b(e,t){var n=this.GetPM(),r="",i="",s="",o="",u=0,a=e.length,f=n.Get("IsResponsive")?n.Get("GetListId"):n.Get("GetFullId"),l=n.Get("GetScrollDir"),c=this.GetTileScrollDirection(),h=this.GetContainer().find(".siebui-tile-list"),p=n.Get("GetControls");for(var d=0;d<t;d++)r=this.GetBasicLayout(),n.Get("IsResponsive")?(o=f.substr(0,f.length-1)+d,r=r.replace(f,o)):(o=f+"_tile_"+d,r=r.replace("tile_1",f+"_tile_"+d)),i+=r;l!==null&&!l?h.children().first().before(i):h.children().last().after(i);if(h.children().length===0)h.append(i);else while(t)l!==null&&!l?h.children().last().remove():h.children().first().remove(),t--;s=h.children(),n.Get("enableDragAndDropInList")&&!n.Get("IsInQueryMode")&&S.call(this,s,n),f=n.Get("IsResponsive")?f.substr(0,f.length-1):f+"_tile_";for(u=0;u<a;u++){var v=f+u;s.eq(u).removeAttr("id").attr("id",v).addClass("siebui-tile").attr("tabindex","-1")}$("#"+f+"_tile_"+n.Get("GetSelection")).addClass("siebui-tile-selected");var m,g;for(var y in p)p.hasOwnProperty(y)&&(m=this.GetUIWrapper(p[y]),g=m.GetEl(undefined,!0),g&&s.eq(0).find(g.eq(0)).length>0&&(m.ShowUI(),m.BindEvents()));for(var y in p){var b=p[y],w=b.GetInputName();if(p.hasOwnProperty(y)&&b.GetUIType()===consts.get("SWE_CTRL_RADIO"))for(u=0;u<a;u++)h.children().eq(u).find("[name*="+w+"]").each(function(){$(this).removeAttr("name").attr("name",w+"_"+u)})}for(u=0;u<a;u++)SiebelAppFacade.TileLayoutPR.superclass.ShowSelection.call(this,u);this.SetFirstTileId(o,a)}function w(t){var n=t.data.ctx.GetPM(),r=t.target.getAttribute("type"),i=r==="checkbox"&&$(t.target).attr("name")===n.Get("GetPlaceholder")+n.Get("MultiSelectColumn");if(t.type==="touchstart"||t.type==="mousedown"&&!t.ctrlKey&&!i&&!t.shiftKey&&!n.Get("MultiSelectMode")){if(n.Get("enableDragAndDropInList")&&t.isDefaultPrevented()){$(t.target).is(":focusable")?$(t.target).focus():$(t.target).closest(":focusable").focus();return}return}if(t.type==="focusin"&&n.Get("MultiSelectMode"))return;if(typeof this.id=="string"){var s=t.data.ctx,o=parseInt(this.id.substring(this.id.lastIndexOf("_")+1),10),u=s.GetPM().Get("GetActiveControl"),a=!1;s.GetIScrollObject().enable(),(u===null||u===undefined)&&!isNaN(o)&&(!i&&!t.ctrlKey&&n.Get("MultiSelectMode")&&!t.data.ctx.IsValidClick(t.target)||s.OnRowSelect(o,t.ctrlKey||i,t.shiftKey
)),t.target.type&&(a=t.target.type.toLowerCase()==="text"||t.target.type.toLowerCase()==="textarea"),!SiebelAppFacade.DecisionManager.IsTouch()&&a&&!e.IsEmpty(t.target.value)&&s.GetIScrollObject().disable()}}function E(e){var n=e.data.ctx.GetPM();n.OnControlEvent(t.get("PHYEVENT_APPLET_FOCUS"))&&(e=e||event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,$(this).prop("checked")===!0?(e.ctrlKey=!0,n.ExecuteMethod("CanInvokeMethod","SelectAll")&&n.ExecuteMethod("InvokeMethod","SelectAll",null)):e.data.ctx.OnRowSelect(0,e.ctrlKey,e.shiftKey))}function S(e,t){e.draggable({revert:"invalid",helper:"clone",scroll:!1,cursor:"move",stack:"#_svf0",appendTo:"#_sweview",zIndex:9999,delay:2e3,start:function(e,n){var r=this.id.substring(this.id.lastIndexOf("_")+1);t.GetRenderer().OnRowSelect(r),$(this).data("rowid",r),$(this).data("appletRowId",t.ExecuteMethod("GetDragInfo",[r])),n.helper.zIndex()===0&&n.helper.zIndex(9999);var i=e;i.type="mouseup",t.GetRenderer().GetIScrollObject()._end(i),i=null}})}function x(e,n,r,i,s,o,u,a){var f=this.GetPM(),l=this.GetPM().Get("GetFullId")+"_"+t.get("SWE_TILE_CONTAINER");$("#"+l).find(e).unbind(a).bind(a,{ctx:this},function(e){if($(this).hasClass("siebui-tile-scroll-d"))return;var t=e.data.ctx.GetIScrollObject(),r,i=0,s=-t.wrapperOffset.left,o=t.scroller.getBoundingClientRect();e.data.ctx.EnableScrollArrow($("#"+l).find(n)),t.enable();if(this.id.search("right")>=0||this.id.search("down")>=0)r=1;else if(this.id.search("left")>=0||this.id.search("up")>=0)r=-1;if(t.options.scrollX)SiebelApp.S_App.GetDirection()&&(r=-r),t.wrapperWidth>-t.maxScrollX?SiebelApp.S_App.GetDirection()?r>0?i=-(o.left-t.wrapperWidth)<t.wrapperWidth?o.left-t.wrapperWidth+$(t.wrapper).offset().left:o.left-s/2-t.scroller.offsetLeft:i=o.right-t.wrapperWidth-$(t.wrapper).offset().left:i=r>0?o.right-s-t.wrapperWidth:i=o.left-s===0?o.left-s-t.scroller.offsetLeft/2:o.left-s:SiebelApp.S_App.GetDirection()?r>0?i=-(o.left-s-1)>=t.wrapperWidth?-(t.wrapperWidth+t.scroller.offsetLeft):o.left-s:i=o.right-s-t.wrapperWidth>t.wrapperWidth?t.wrapperWidth+t.scroller.offsetLeft:o.right-s-t.wrapperWidth:r>0?i=o.right-s-t.wrapperWidth>t.wrapperWidth?t.wrapperWidth:o.right-s-t.wrapperWidth:i=-(o.left-s-1)>=t.wrapperWidth?-t.wrapperWidth:o.left-s;else if(r>0){var u=e.data.ctx.GetContainer().children("div.siebui-tile-list").offset().top+t.scrollerHeight-($("#"+t.wrapper.id).offset().top+t.wrapperHeight);i=u>=t.wrapperHeight?t.wrapperHeight:u}else-t.y>=t.wrapperHeight?i=t.wrapperHeight:i=t.y===0?0:-t.y,i=i>0?-i:i;t.options.scrollX?i=t.wrapperWidth>=t.scrollerWidth?0:i:i=t.wrapperHeight>=t.scrollerHeight?0:i,setTimeout(function(){SiebelApp.S_App.GetDirection()&&t.options.scrollX&&(r=-r),i=Math.ceil(i),i=parseInt(i,10),t.options.scrollX?t.directionX=r:t.directionY=r,t.options.scrollX?t.scrollBy(-i,0,1e3):t.scrollBy(0,-i,1e3)},0)})}function T(){var e,t=this.Get("GetSelection");return this.Get("GetRecordSet").length===1&&(t=0),this.Get("IsResponsive")?(e=this.Get("GetListId"),e=e.substr(0,e.length-1),e+=t):e=this.Get("GetFullId")+"_tile_"+t,e}var e=SiebelJS.Dependency("SiebelApp.Utils"),t=SiebelJS.Dependency("SiebelApp.Constants"),n=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject");SCROLL_UP=consts.get("PAG_SCROLL_UP"),SCROLL_DN=consts.get("PAG_SCROLL_DN");var r="easeInOutQuad",i=t.get("SWE_CTRL_MVG"),s=t.get("SWE_CTRL_PICK");return SiebelJS.Extend(o,SiebelAppFacade.PhysicalRenderer),o.prototype.Init=function(){SiebelAppFacade.TileLayoutPR.superclass.Init.call(this),this.AttachPMBinding("OnScrollComplete",g)},o.prototype.FocusFirstControl=function(){var t=this.GetPM(),n=t.Get("ListOfColumns"),r=n.length,o=9999,u=null,a=0;this.SetFirstControl(null);for(var f=0;f<r;f++){var l=n[f].control,c=l.GetFieldName();if(!e.IsEmpty(c)&&l.GetIndex()&&l.GetIndex()<o){var h=!1;t.Get("IsInQueryMode")===!1?h=t.ExecuteMethod("CanUpdate",l.GetName()):h=!0;if(h&&!e.IsEmpty(l.GetUIType())&&(l.isBasicControl()||l.GetUIType()[0]==="J"||l.GetUIType()===i||l.GetUIType()===s)){var p=Number(t.Get("GetSelection"));this.SetFirstControl(this.GetUIWrapper(l).GetEl(p).eq(0));break}}}if(this.GetFirstControl()!=null){this.GetFirstControl().focus();return}return!1},o.prototype.ShowUI=function(e){this.init=!0;var r=this.GetPM(),i=r.Get("IsResponsive")?r.Get("GetListId"):r.Get("GetFullId"),s=r.Get("GetFullId")+"_"+t.get("SWE_TILE_CONTAINER");this.SetContainer($("#"+s)),p.call(this);if(r.Get("MultiSelectColumn")){var o=r.Get("GetPlaceholder")+r.Get("MultiSelectColumn"),u="id_"+o,a="header_"+o,f=this.GetContainer().find(".siebui-"+r.Get("MultiSelectColumn")),c='<input type="checkbox" name='+o+' role="checkbox" tabindex="-1" aria-checked="false" title='+n.GetLocalString("IDS_BHC_UNCHECKED")+"/>";f.length||(f=this.GetContainer().children(":first"),c="<div> "+c+"</div>"),f.prepend(c);var h=$("#s_"+i+"_div").find(".siebui-applet-buttons").eq(0);h.prepend('<div><input type="checkbox" tabindex="-1" title='+n.GetLocalString("IDS_BHC_UNCHECKED")+" id="+u+" name="+a+' aria-checked="false" aria-disable="false"></div>')}this.SetBasicLayout(this.GetContainer().html()),this.GetContainer().html('<div class="siebui-tile-list"></div>'),SiebelAppFacade.TileLayoutPR.superclass.ShowUI.call(this),this.SetTileScrollDirection(l.call(this)),SiebelAppFacade.DecisionManager.IsTouch()?this.GetContainer().parent(".siebui-tile-container").addClass("siebui-touch"):this.EnhanceScroller()},o.prototype.ClearData=function(){var e=this.GetContainer().children("div.siebui-tile-list"),t=this.GetTileScrollDirection();this.GetPM().Get("IsInQueryMode")&&(this.GetIScrollObject().destroy(),this.GetContainer().find("#tile-left-scroll, #tile-right-scroll, #tile-up-scroll, #tile-down-scroll").addClass("siebui-tile-scroll-d"),this.init=!0),e.empty(),e=null},o.prototype.BindData=function(e){var t=this.GetPM(),n,r=t.Get("GetRecordSet"),i=r?r.length:0,s=t.Get("GetSelection"),o=t.Get("GetScrollDir"),u=parseInt(t.Get("GetScrollAmount")),a=u?u:i;if(!this.GetBasicLayout())return;SiebelApp.S_App.GetDirection
()&&this.GetTileScrollDirection().toLowerCase()==="horizontal"&&this.GetContainer().find(".siebui-tile-list").removeClass("siebui-float-left"),a=a<0?-a:a,a=a>i?i:a,a=parseInt(a,10),this.GetContainer().addClass("clearfix"),this.SetScrollAmount(u);if(i===0){this.GetContainer().children("div.siebui-tile-list").empty(),this.UpdateScrollArrows();return}o!==null&&u!==0&&Math.abs(u)<i?(n=!0,b.call(this,r,a)):e?(this.ClearData(),b.call(this,r,a)):e||b.call(this,r,a);var f=this.GetPM().Get("GetSelId");$("#"+f+s).addClass("siebui-tile-selected"),this.init&&!t.Get("IsInQueryMode")&&(d.call(this),this.init=!1),h.call(this)&&c.call(this);if(o===null&&u===0){var l=this.GetIScrollObject();l.refresh(),l.options.scrollY&&(l.maxScrollY=-(l.scrollerHeight-l.wrapperHeight),l.wrapperHeight>=l.scrollerHeight&&(l.maxScrollY=0,l._translate(0,0),this.GetContainer().find("#tile-up-scroll").addClass("siebui-tile-scroll-d")))}record=null},o.prototype.SetFirstTileId=function(e,t){var n=this.GetTileScrollDirection(),r=$("#"+e).outerHeight(!0),i=$("#"+e).outerWidth(!0);this.SetTileHeight($("#"+e).outerHeight(!0)),this.SetTileWidth($("#"+e).outerWidth(!0)),this.GetContainer().parent(".siebui-tile-container").removeClass("siebui-horizontal siebui-vertical"),this.GetContainer().find(".siebui-tile-list").css({width:"",height:""}),!n||n.toLowerCase()==="horizontal"?(this.GetContainer().parent(".siebui-tile-container").addClass("siebui-horizontal"),this.SetContainerHeight(r*t),this.SetContainerWidth(parseInt(i*t/2),10)):(this.GetContainer().parent(".siebui-tile-container").addClass("siebui-vertical"),parseInt(this.GetContainer().children("div.siebui-tile-list").css("max-height"),10)>0?this.GetContainer().children("div.siebui-tile-list").outerHeight(!0)<parseInt(this.GetContainer().children("div.siebui-tile-list").css("max-height"),10)?this.SetContainerHeight(this.GetContainer().children("div.siebui-tile-list").outerHeight(!0)):this.SetContainerHeight(parseInt(this.GetContainer().children("div.siebui-tile-list").css("max-height"),10)):this.SetContainerHeight(this.GetContainer().height())),(!this.GetTileScrollDirection()||this.GetTileScrollDirection().toLowerCase()==="horizontal")&&this.GetContainer().children("div.siebui-tile-list").outerHeight(r),SiebelAppFacade.DecisionManager.IsTouch()||this.UpdateScrollArrows();if(this.GetTileScrollDirection().toLowerCase()==="horizontal"){var s=Math.floor(this.GetContainer().height()/this.GetTileHeight());s>1?this.GetContainer().find(".siebui-tile-list").css("width",Math.ceil(this.GetTileWidth()*this.GetPM().Get("GetRecordSet").length/s)):this.GetContainer().find(".siebui-tile-list").css("width",this.GetTileWidth()*this.GetPM().Get("GetRecordSet").length)}else{var s=Math.floor(this.GetContainer().width()/this.GetTileWidth());s>1?this.GetContainer().find(".siebui-tile-list").css("minHeight",$("#"+e).height()*Math.ceil(this.GetPM().Get("GetRecordSet").length/s)):this.GetContainer().find(".siebui-tile-list").css("minHeight",$("#"+e).height()*this.GetPM().Get("GetRecordSet").length)}},o.prototype.UpdateScrollArrows=function(){var e=this.GetTileScrollDirection(),t=this.GetPM(),n=$("#"+t.Get("GetFullId")+"_"+consts.get("SWE_TILE_CONTAINER")),r=0,i=t.Get("GetRecordSet")?t.Get("GetRecordSet").length:0;!e||e.toLowerCase()==="horizontal"?(r=parseInt((n.width()||$("#s_"+t.Get("GetFullId")+"_div").width())/this.GetTileWidth(),10),i>r?SiebelApp.S_App.GetDirection()?n.find("#tile-left-scroll").removeClass("siebui-tile-scroll-d"):n.find("#tile-right-scroll").removeClass("siebui-tile-scroll-d"):i===r&&t.ExecuteMethod("CanInvokeScrollMethod","ScrollNextData")?SiebelApp.S_App.GetDirection()?n.find("#tile-left-scroll").removeClass("siebui-tile-scroll-d"):n.find("#tile-right-scroll").removeClass("siebui-tile-scroll-d"):SiebelApp.S_App.GetDirection()?(n.find("#tile-left-scroll").addClass("siebui-tile-scroll-d"),n.find(".siebui-tile-list").removeClass("siebui-float-left")):n.find("#tile-right-scroll").addClass("siebui-tile-scroll-d")):(r=parseInt(this.GetContainerHeight()/this.GetTileHeight(),10),i===0||i<=r?n.find("#tile-down-scroll").addClass("siebui-tile-scroll-d"):n.find("#tile-down-scroll").removeClass("siebui-tile-scroll-d"))},o.prototype.IsValidClick=function(e){var t=SiebelAppFacade.TileLayoutPR.superclass.IsValidClick.apply(this,arguments);return t&&$(e).parent("button").length&&(t=!1),t},o.prototype.BindEvents=function(){SiebelAppFacade.TileLayoutPR.superclass.BindEvents.call(this);var e=this.GetPM(),n=e.Get("IsResponsive")?this.GetPM().Get("GetListId"):e.Get("GetFullId")+"_tile_",r=e.Get("GetRecordSet"),i=r?r.length:0,s=this.GetTileScrollDirection(),o=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper"),u=$("#s_"+e.Get("GetFullId")+"_div");u.off("click.drilldown").on("click.drilldown",".siebui-ctrl-drilldown",{ctx:this},function(e){var n=e.data.ctx,r=e.data.ctx.GetPM().Get("GetControls"),i=this.id.indexOf("_mb"),s=$(this).parents(".siebui-tile").attr("id"),o=parseInt(s.substring(s.lastIndexOf("_")+1),10),u=this.id.substring(0,i);for(var a in r)if(r.hasOwnProperty(a)){var f=r[a];if(f.GetInputName()===u&&!isNaN(i)&&n.OnRowSelect(o)){n.GetPM().OnControlEvent(t.get("PHYEVENT_DRILLDOWN_LIST"),$(this).attr("name"),o);break}}}),u.on("click",".siebui-applet-header.siebui-collapsible .siebui-button-secondary.siebui-btn-icon-expanded",{ctx:this},function(e){a.call(e.data.ctx)}),u=null;var l;if(e.Get("IsResponsive")){var p=n.substr(0,n.length-1);l="[id^='"+p+""+"']"}else l="[id^='"+n+""+"']";this.GetContainer().delegate(l,"focusin mousedown touchstart",{ctx:this},w),!s||s.toLowerCase()==="horizontal"?(x.call(this,"#tile-left-scroll","#tile-right-scroll","ScrollPrevData","ScrollNextData",SCROLL_UP,"margin-left","marginLeft","mousedown"),x.call(this,"#tile-right-scroll","#tile-left-scroll","ScrollNextData","ScrollPrevData",SCROLL_DN,"margin-left","marginLeft","mousedown")):(x.call(this,"#tile-up-scroll","#tile-down-scroll","ScrollPrevData","ScrollNextData",SCROLL_UP,"","scrollTop","mousedown"),x.call(this,"#tile-down-scroll"
,"#tile-up-scroll","ScrollNextData","ScrollPrevData",SCROLL_DN,"","scrollTop","mousedown")),e.Get("enableDragAndDropInList")&&($("#s_"+e.Get("GetFullId")+"_div").bind("dragover",function(e){e.preventDefault()}).bind("drop",{ctx:this},function(e){e.preventDefault();var n,r;e.originalEvent.dataTransfer&&(n=e.originalEvent.dataTransfer.getData("Text")),n&&(n.indexOf("\r")!==-1?r=n.replace(/\n/g,"").split("\r"):r=n.split("\n"),e.data.ctx.GetPM().OnControlEvent(t.get("PHYEVENT_RECORD_DROP"),r))}),$("#s_"+this.GetPM().Get("GetFullId")+"_div").droppable({drop:function(e,t){if(!($(".ui-widget-overlay").not("[id]").length>0&&SiebelApp.S_App.GetPopupPM().Get("state")===consts.get("POPUP_STATE_VISIBLE"))){var n=$(this).droppable("option","ctx").GetPM();t.helper.detach(),n.OnControlEvent(consts.get("PHYEVENT_RECORD_DROP_GENERIC"),n.Get("dropMethod"))}},ctx:this}));var d=e.Get("MultiSelectColumn");d&&$("#id_"+e.Get("GetPlaceholder")+d).bind("click",{ctx:this},E),h.call(this)&&$(window).bind("resize."+e.Get("GetPlaceholder"),f(c,100,this)),$(window).bind("resizeTile."+e.Get("GetPlaceholder"),{ctx:this},v)},o.prototype.ShowSelection=function(){var e=this.GetPM(),t=e.Get("GetRowsSelectedArray"),r=e.Get("GetRecordSet").length,i=e.Get("MultiSelectColumn")?e.Get("GetPlaceholder")+e.Get("MultiSelectColumn"):null,s=e.Get("selectctrlinfo"),o=e.Get("GetSelection"),u,a=!0,f=e.Get("IsResponsive")?e.Get("GetListId"):e.Get("GetFullId");f=e.Get("IsResponsive")?f.substr(0,f.length-1):f+"_tile_",r===1&&(o=0),t.length!==0&&$(this.GetContainer()).find(".siebui-tile-selected").removeClass("siebui-tile-selected");if(i){var l=$($('input[name="'+i+'"]'));l&&(setTimeout(function(){l.prop("checked",!1)},0),l.attr({title:n.GetLocalString("IDS_BHC_UNCHECKED"),"aria-checked":"false"}))}else t.length==0&&$("#"+e.Get("GetSelId")).addClass("siebui-tile-selected");for(var c=0;c<r&&c<t.length;c++)t[c]&&$("#"+f+c).addClass("siebui-tile-selected");setTimeout(function(){for(var e=0;e<r&&e<t.length;e++)if(t[e]){if(i){var o=$($('input[name="'+i+'"]')[e]);u=!0,s&&s[e+1]&&s[e+1]==="0"&&(u=!1),o&&u&&(o.prop("checked",!0),o.attr({title:n.GetLocalString("IDS_BHC_CHECKED"),"aria-checked":"true"}))}}else a=!1;if(i){if(r!==t.length&&t.length<=1||!r)a=!1;var f="header_"+i,l=$($('input[name="'+f+'"]'));l&&l.length&&l.prop("checked",a).attr("aria-checked",""+a)}},0),o>=0&&SiebelAppFacade.TileLayoutPR.superclass.ShowSelection.call(this,o)},o.prototype.OnRowSelect=function(e,n,r){var i=this.GetPM(),s=this;return!n&&!r&&Number(e)===Number(i.Get("GetSelection"))&&this.GetContainer().find(".siebui-tile-selected").length===1?!0:(SiebelApp.S_App.uiStatus.Busy({}),i.OnControlEvent(t.get("PHYEVENT_SELECT_ROW"),e,n,r)?(SiebelApp.S_App.uiStatus.Free(),!0):(SiebelApp.S_App.uiStatus.Free(),!1))},o.prototype.EnableScrollArrow=function(e){e.length>0&&e.removeClass("siebui-tile-scroll-d")},o.prototype.EnhanceScroller=function(){var t=this.GetPM(),n=t.Get("GetFullId"),r=null,i=(this.GetTileScrollDirection()||"horizontal").toLowerCase()==="horizontal",s="<div id='"+n+"_scrollarea' class='siebui-tile-scrollarea'></div>",o=e.IsTrue(SiebelApp.S_App.IsAutoOn()),u="";o&&(u=' ot="button" rn="${DIRECTION}scroll" un="${DIRECTION}scroll" '),r='<div id="tile-${DIRECTION}-scroll"'+u+' class="siebui-tile-${DIRECTION}-scroll siebui-tile-scroll-d">'+'<a class="siebui-tile-scroll-anchor" href="#"/>'+"</div>",$("#"+n+"_scrollarea").remove(),i?(this.GetContainer().children("div.siebui-tile-list").after(s),$("#"+n+"_scrollarea").append(r.replace(/\${DIRECTION}/g,"left")+r.replace(/\${DIRECTION}/g,"right"))):(this.GetContainer().children("div.siebui-tile-list").after(s),$("#"+n+"_scrollarea").append(r.replace(/\${DIRECTION}/g,"up")+r.replace(/\${DIRECTION}/g,"down")))},o.prototype.EndLife=function(){this.SetBasicLayout(null),this.GetContainer().empty(),$("#scrollarea").empty(),this.GetIScrollObject()&&this.GetIScrollObject().destroy(),this.SetIScrollObject(null),$("#s_"+this.GetPM().Get("GetFullId")+"_div").off("click.drilldown"),h.call(this)&&$(window).unbind("resize."+this.GetPM().Get("GetPlaceholder")),$(window).unbind("resizeTile."+this.GetPM().Get("GetPlaceholder")),SiebelAppFacade.TileLayoutPR.superclass.EndLife.call(this)},o}(),"SiebelAppFacade.TileLayoutPR"}));
