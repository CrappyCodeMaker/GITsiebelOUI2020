/*<ORACLECOPYRIGHT>
* Copyright (C) 2008-2016
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 16.0.0.0SIA[23057] */
typeof SiebelAppFacade.JSTreeRenderer=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.JSTreeRenderer"),define("siebel/jsTreeCtrl",["siebel/basephyrenderer","3rdParty/fancytree/dist/jquery.fancytree.min.js"],function(){return SiebelAppFacade.JSTreeRenderer=function(){function s(){SiebelAppFacade.JSTreeRenderer.superclass.constructor.apply(this,arguments);var t={};this.GetDataSet=function(){return t},this.EmptyDataSet=function(){t={}},this.GetKey=function(){var t=e.get("SWE_PROP_NC_ID_SCREEN_CONTROL"),n=this.GetPM().Get("IsScreen")?"screenName":"viewName";return this.GetKey=function(){return n},n}}function o(e,t){var n="siebui-nav-tree",r=$("div#"+e+"."+n);if(t&&r.length===0){r=$('div[id="'+e+'"]');if(r.length){r=r.not(function(){return $(this).hasClass("siebui-nav-hb")}),r=r.eq(0);var i=(r.attr("class")||"").split(" ");for(var s=0,o=i.length;s<o;s++)i[s].indexOf("siebui-nav-")===0&&i[s]!==n&&r.removeClass(i[s]);r.addClass(n)}}else r.length&&(r=r.eq(0));return r}function u(s){var o=this;if(s.length===1){s.fancytree({autoCollapse:!0,imagePath:" ",_classNames:{nodeIcon:null},clickFolderMode:3,minExpandLevel:1,persist:!1,renderNode:function(e,t){var n=t.node;n.data.addClass&&$(n.span).addClass(n.data.addClass)},click:function(s,u){var a,f=o.GetPM(),l=u.node;if(l&&$.ui.fancytree.getEventTargetType(s.originalEvent)==="title"&&l.key){var c;if(l.folder===!0)o.GetDataSet()!==null&&(a=o.GetDataSet()[l.key],c=a[f.Get("IsScreen")?"defaultViewName":o.GetKey()],a.viewName=c,f.Get("GetType")===e.get("SWE_PROP_NC_ID_SCREEN_CONTROL")?a.level=t:a.level=r);else{var h=f.Get("GetSelectedTabKey"),p=null;h!==null&&h!==undefined&&(a=f.Get("GetTabInfo")[h]),c=a.links[l.key].viewName,a.viewName=c,f.Get("GetType")===e.get("SWE_PROP_NC_ID_SCREEN_CONTROL")?a.level=n:a.level=i}return f.OnControlEvent("OnClick",a)?!0:!1}return!1}});var u=o.GetPM(),a=u.Get("GetType")===e.get("SWE_PROP_NC_ID_SCREEN_CONTROL")?"siebui-view-navs":"siebui-subview-navs";s.hasClass(a)||s.addClass(a),this.TreeLoaded=!0}}function a(t,n){var r=this.GetPM(),i=r.Get("GetTabContainerQTPInfo"),s=r.Get("GetTabItemsQTPInfo"),o=r.Get("IsScreen")?r.Get("GetTabInfo")[r.Get("GetSelectedTabKey")]&&r.Get("GetTabInfo")[r.Get("GetSelectedTabKey")].screenName:r.Get("GetTabInfo")[r.Get("GetSelectedTabKey")]&&r.Get("GetTabInfo")[r.Get("GetSelectedTabKey")].viewName,u=r.Get("GetTabViewLinkContainerQTPInfo"),a=r.Get("GetTabViewLinkItemsQTPInfo"),f=e.get("SWE_PROP_QTP_OT"),l=e.get("SWE_PROP_QTP_RN"),c=e.get("SWE_PROP_QTP_UN");i&&typeof i.GetProperty=="function"&&(t.ul.setAttribute("ot",i.GetProperty(f)),t.ul.setAttribute("rn",i.GetProperty(l)),t.ul.setAttribute("un",i.GetProperty(c)));var h=t.getChildren()?t.getChildren().length:0;for(var p=0;p<h;p++){var d=t.getChildren()[p];s[p]&&typeof s[p].GetProperty=="function"&&(d.li.setAttribute("ot",s[p].GetProperty(f)),d.li.setAttribute("rn",s[p].GetProperty(l)),d.li.setAttribute("un",s[p].GetProperty(c)));if(d.getChildren()!==null&&o===d.data.key){u&&typeof u.GetProperty=="function"&&(d.ul.setAttribute("ot",u.GetProperty(f)),d.ul.setAttribute("rn",u.GetProperty(l)),d.ul.setAttribute("un",u.GetProperty(c)));for(var v=0;v<d.getChildren().length;v++){var m=d.getChildren()[v];a[v]&&typeof a[v].GetProperty=="function"&&(m.li.setAttribute("ot",a[v].GetProperty(f)),m.li.setAttribute("rn",a[v].GetProperty(l)),m.li.setAttribute("un",a[v].GetProperty(c)))}}}if(!n.overflow)return;var t=$("#"+n.comboContainer),g=r.Get("GetJumpTabQTPInfo"),f=e.get("SWE_PROP_QTP_OT"),l=e.get("SWE_PROP_QTP_RN"),c=e.get("SWE_PROP_QTP_UN"),y=n.chtotal-n.count;g&&typeof g.GetProperty=="function"&&(t.attr("ot",g.GetProperty(f)),t.attr("rn",g.GetProperty(l)),t.attr("un",g.GetProperty(c))),d=t.children("option");var v=1;for(p=y;p<n.chtotal&&d.length>0;p++)s[p]&&typeof s[p].GetProperty=="function"&&(d.eq(v).attr("ot",s[p].GetProperty(f)),d.eq(v).attr("rn",s[p].GetProperty(l)),d.eq(v).attr("un",s[p].GetProperty(c)),v++)}function f(n){var i=e.get("SWE_PROP_NC_ID_SCREEN_CONTROL"),s=e.get("SWE_PROP_NC_ID_VIEW_CONTROL"),u=null;switch(n){case t:u=o.call(this,i),u.fancytree("getRootNode")?u.find(" ul  li a").eq(1).focus():u.find(" ul  li a").eq(0).focus();break;case r:u=o.call(this,s),u.find(" ul  li a").eq(0).focus()}}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=e.get("SWE_SCREEN_NAV_CONTROL_STR"),n=e.get("SWE_AGGR_VIEW_NAV_CONTROL_STR"),r=e.get("SWE_DET_VIEW_NAV_CONTROL_STR"),i=e.get("SWE_DET_SUB_VIEW_NAV_CONTROL_STR");return SiebelJS.Extend(s,SiebelAppFacade.BasePR),s.prototype.Init=function(){SiebelAppFacade.JSTreeRenderer.superclass.Init.apply(this,arguments),this.GetPM().Get("IsScreen")&&this.AttachPMBinding("Refresh",this.BindData),this.GetPM().AttachPMBinding("FocusNavLink",f,{scope:this})},s.prototype.ShowUI=function(){var t=this.GetPM(),n=SiebelApp.S_App.IsRwd()?t.Get("placeholder"):t.Get("GetType"),r=o.call(this,n,!0);SiebelJS.Debug("[JSTreeRenderer] -> jqcontainer = "+r.length),n===e.get("SWE_PROP_NC_ID_VIEW_CONTROL")&&o.call(this,e.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL"),!0).length!==0&&(n=e.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")),t.SetProperty("LevelPlaceholder",n),u.call(this,r)},s.prototype.BindEvents=function(){var e=this;$(window).resize(function(){e.TreeLoaded&&e.Refresh(!0)})},s.prototype.BindData=function(){var e=this.GetPM(),t=e.Get("GetDataReload"),n=e.Get("GetTabInfo"),r=e.Get("GetSelectedTabLinkInfo"),i,s;t&&this.EmptyDataSet();var o=this.GetDataSet(),u={};if(n!==null&&t)for(s in n)if(n.hasOwnProperty(s)){if(s.search("tabScreen")===-1)continue;i=n[s],o[i[this.GetKey()]]=i}var a=e.Get("GetSelectedTabKey"),f=null;a!==null&&a!==undefined&&n[a]!==undefined&&(f=n[a][this.GetKey()]);var l=!1;if(r!==null&&o[f]!==undefined&&o[f].links===undefined){var c=!1;for(s in r)if(r.hasOwnProperty(s)){if(s.search("tabView")===-1)continue;i=r[s],u[i.viewName]=i,c=!0}c&&(o[f].links=u,l=!0)}t&&(l=!0),this.Refresh(l)},s.prototype.Refresh=function(t){if(!t)return;var n=this.GetPM(),i=o.call(this,SiebelApp.S_App.IsRwd()?n.Get("placeholder"):n.Get("GetType"));if(
i.fancytree("getRootNode").length===0)return;i.fancytree("getRootNode").removeChildren();var s=n.Get("GetTabInfo")||{};if(!s.tabScreen0)return;var f=n.Get("GetSelectedTabLinkInfo")||{},l=i.fancytree("getRootNode"),c,h,p,d=!0;n.Get("IsScreen")?c=l.addChildren({title:"Screens",key:"AllScreens",addClass:"fancytree-root-tag",folder:!0,expanded:!0,url:null}):c=l;var v=n.Get("GetSelectedTabKey"),m=null;m=(s[v]||s.tabScreen0)[this.GetKey()],m=String(m);var g=n.Get("GetSelectedLinkKey"),y=null;g!==null&&g!==undefined&&(y=f[g]?f[g].viewName:""),y=String(y);var b=i.width()>i.height()?1:0,w=b?i.width():i.height(),E=45,S=!1,x=SiebelApp.S_App.IsRwd()?"j_"+n.Get("placeholder"):"j_"+n.Get("GetType"),T=n.Get("IsScreen")?"siebui-nav-screenlist":"siebui-nav-viewlist",N='<select id="'+x+'" class="'+T+'"><option></option>',C=!1,k=n.Get("GetTabInfo")[n.Get("GetSelectedTabKey")]||n.Get("GetTabInfo").tabScreen0,L=null;L=c.addChildren({title:k.captionName,folder:!0,url:k.captionName,icon:k.tabIcon,active:k.captionName===m,addClass:k.captionName===m?"screen-tab-selected":"screen-tab-deselected",expanded:k.captionName===m,key:k});var A=$($(L)[0].li).outerWidth(!0);E+=A,c.removeChildren(),$("#"+x).remove();var O=0,M=0,_=this.GetDataSet(),D;for(var P in _)if(_.hasOwnProperty(P)){if(!S){D="";if(_[P].tabBmpHTMLAttrib){var H=_[P].tabBmpHTMLAttrib.indexOf("=");D=_[P].tabBmpHTMLAttrib.substring(H+1).replace(/\"/g,"")}h=c.addChildren({title:_[P].captionName,folder:!0,url:_[P].captionName,icon:_[P].tabIcon,addClass:(P===m?"screen-tab-selected":"screen-tab-deselected")+" "+D,expanded:P===m,key:P}),P===m&&(C=!0,E-=A);var B=this.GetDataSet()[P].links,j=h,F=!1;for(p in B)if(B.hasOwnProperty(p)){if(d&&n.Get("LevelPlaceholder")===e.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")){var I=o.call(this,n.Get("LevelPlaceholder"));u.call(this,I);if(I.fancytree("getRootNode").length===0)return;I.fancytree("getRootNode").removeChildren(),j=I.fancytree("getRootNode"),d=!1}var q=j.addChildren({title:B[p].captionName,folder:!1,url:B[p].captionName,active:p===y,addClass:n.Get("LevelPlaceholder")===e.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")?p===y?"screen-tab-selected":"screen-tab-deselected":p===y?"view-tab-selected":"view-tab-deselected",key:p});p===y&&(F=!0)}P===m&&!F&&h.setActive(!0);var R=b?$($(h)[0].li).outerWidth(!0):$($(h)[0].li).outerHeight(!0);E+R<=w?E+=R:b&&(S=!0,h.remove(),N+="<option value = "+this.GetDataSet()[P].captionName+">"+this.GetDataSet()[P].captionName+"</option>",M++)}else N+="<option value = "+this.GetDataSet()[P].captionName+">"+this.GetDataSet()[P].captionName+"</option>",M++;O++}if(S){N+="</select>",i.append(N);var U=this.GetDataSet()[m].captionName;$("#"+x).find("option").each(function(){String(U)===$(this).text()&&$(this).remove()})}if(!C){var z=n.Get("IsScreen")?String(k.screenName):String(k.viewName);h=c.addChildren({title:k.captionName,folder:!0,url:k.captionName,icon:k.tabIcon,active:!1,addClass:z===m?"screen-tab-selected":"screen-tab-deselected",expanded:z===m,key:z});var W=!1;for(p in k.links)if(k.links.hasOwnProperty(p)){var X=h.addChildren({title:k.links[p].captionName,folder:!1,url:k.links[p].captionName,active:p===y,key:p});p===y&&(W=!0)}!W&&z===m&&h.setActive(!0)}var V=this;$("#"+x).change(function(){var e=$("#"+x).find("option:selected").text(),t=V.GetDataSet(),i="";for(var s in t)t.hasOwnProperty(s)&&e===String(t[s].captionName)&&(i=t[s].viewName,t[s].level=r,i||(t[s].viewName=t[s].defaultViewName),n.OnControlEvent("OnClick",t[s]))});var J={};J.comboContainer=x,J.chtotal=O,J.count=M,J.overflow=S,a.call(this,c,J),c.setExpanded(!0).done(function(){})},s}(),"SiebelAppFacade.JSTreeRenderer"}));
